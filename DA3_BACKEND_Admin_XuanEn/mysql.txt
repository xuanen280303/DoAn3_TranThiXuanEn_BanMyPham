CREATE DATABASE ShopMyPham
USE ShopMyPham

CREATE TABLE TaiKhoan (
	MaTaiKhoan INT PRIMARY KEY auto_increment,
	TenTaiKhoan Nvarchar(20),
	MatKhau Nvarchar(20),
	Email Varchar(30) CHECK (Email LIKE '%@%'),
	SDT Varchar(20),
	Quyen Int
);

CREATE TABLE BaiViet (
	MaBV INT PRIMARY KEY auto_increment,
	TieuDe Nvarchar(100),
	NguoiDang Nvarchar(20),
	TGDang Date,
	NgayKT Date, 
	NoiDung text
);

CREATE TABLE LoaiMyPham
(
	MaLoaiMP INT PRIMARY KEY auto_increment,
	TenLoaiMP Nvarchar(30) not null, 
	AnhDaiDien nvarchar(500),
	MoTa text
);

CREATE TABLE MyPham
(
	MaMP INT PRIMARY KEY auto_increment,
	TenMP Nvarchar(50),
	MaLoaiMP INT, FOREIGN KEY (MaLoaiMP) REFERENCES LoaiMyPham(MaLoaiMP) ON DELETE CASCADE ON UPDATE CASCADE,
	GiaBan Decimal(10, 2),
	XuatXu Nvarchar(30),
	KhoiLuong Nvarchar(10),
	NgaySX Date,
	HSD Nvarchar(10),
	SLTon Int check (SLTon>=0),
	AnhDaiDien nvarchar(500),
	MoTa text,
	GhiChu Nvarchar(30)
);

CREATE TABLE GiaBan (
    MaGB INT PRIMARY KEY AUTO_INCREMENT,
    MaMP INT,
    GiaBan FLOAT,
    NgayBD DATE,
    NgayKT DATE,
    FOREIGN KEY (MaMP) REFERENCES MyPham(MaMP),
    CONSTRAINT check_NgayBD CHECK (YEAR(NgayBD) > 2023),
    CONSTRAINT check_NgayKT CHECK (YEAR(NgayKT) > YEAR(NgayBD))
);

CREATE TABLE NhanVien
(
	MaNV INT PRIMARY KEY auto_increment,
	MaTaiKhoan Int UNIQUE, FOREIGN KEY (MaTaiKhoan) REFERENCES TaiKhoan(MaTaiKhoan),
	HoTenNV Nvarchar(30),
	ChucVu Nvarchar(20),
	Luong Decimal(10, 2),
	CaLam Nvarchar(8),
	SDTNV Varchar(11) DEFAULT N'Không có',
	DiachiNV Nvarchar(30)
);

CREATE TABLE KhachHang
(
	MaKH INT PRIMARY KEY auto_increment,
	MaTaiKhoan Int UNIQUE,
	HoTenKH Nvarchar(30),
	SDTKH Varchar(11) DEFAULT N'Không có',
	DiaChiKH Nvarchar(30),
	FOREIGN KEY (MaTaiKhoan) REFERENCES TaiKhoan(MaTaiKhoan)
);

CREATE TABLE NhaCC
(
	MaNCC Int PRIMARY KEY auto_increment,
	HoTenNCC Nvarchar(30) not null,
	SDTNCC Varchar(11) DEFAULT N'Không có',
	DiaChiNCC Nvarchar(30)
);

CREATE TABLE HoaDonNhap
(
	MaHDN Int PRIMARY KEY auto_increment,
	MaNV Int, FOREIGN KEY(MaNV) REFERENCES NhanVien(MaNV),
	MaNCC Int,  FOREIGN KEY(MaNCC) REFERENCES NhaCC(MaNCC),
	NgayNhap Date,
	KieuThanhToan Nvarchar(20),
	TongTien float
);

CREATE TABLE ChiTietHoaDonNhap
(
	MaCTHDN Int PRIMARY KEY auto_increment,
	MaHDN Int, FOREIGN KEY (MaHDN) REFERENCES HoaDonNhap(MaHDN),
	MaMP Int,  FOREIGN KEY (MaMP) REFERENCES MyPham(MaMP),
	TenMP Nvarchar(50) not null, 
	SLNhap float check (SLNhap>0),
	DGNhap float check (DGNhap>0),
	ThanhTien float check (ThanhTien>=0)
);

CREATE TABLE HoaDonBan
(
	MaHDB INT PRIMARY KEY auto_increment,
	HoTenKH Nvarchar(30),
	SDTKH Varchar(10) DEFAULT N'Không có',
	DiaChiKH nvarchar(30),
	TrangThai bit,
	NgayTao datetime,
	NgayDuyet datetime,
	TongTien decimal(18, 0),
	TGGiaoHang datetime
);

CREATE TABLE ChiTietHoaDonBan
(
	MaCTHDB INT PRIMARY KEY auto_increment,
	MaHDB INT, FOREIGN KEY(MaHDB) REFERENCES HoaDonBan(MaHDB),
	MaMP Int, FOREIGN KEY(MaMP) REFERENCES MyPham(MaMP),
	SLBan INT CHECK (SLBan>0),
	TongTien decimal(18, 0)
)

-----------------------Thêm dữ liệu------------------------------------------------
INSERT INTO TaiKhoan (TenTaiKhoan, MatKhau, Email, SDT, Quyen) 
VALUES  ('user1', 'a12345678', 'user1@example.com', '123456789', 1),
		('user2', 'b12345678','user2@example.com', '987654321', 2),
		('user3', 'c12345678','user3@example.com', '456789123', 1),
		('user4', 'e12345678', 'user4@example.com', '789123456', 2),
		('user5', 'f12345678','user5@example.com', '321654987', 1);

--INSERT BaiViet(MaBV, TieuDe, NguoiDang, TGDang, NgayKT, NoiDung)
INSERT INTO BaiViet(TieuDe, NguoiDang, TGDang, NgayKT, NoiDung)
VALUES( N'Dùng kem chống nắng như thế nào?', N'Nhân viên', '09-09-2023', '01-09-2024', N'Dùng mỗi ngày'),
      ( N'Dùng nước tẩy trang như thế nào?', N'Quản lý', '05-12-2023', '01-01-2024', N'Dùng mỗi ngày'),
	  ( N'Dùng toner như thế nào?', N'Nhân viên', '03-08-2023', '05-03-2024', N'Dùng mỗi ngày')

	  SELECT * FROM BaiViet

-- INSERT LoaiMyPham(MaLoaiMP, TenLoaiMP, AnhDaiDien, MoTa)
INSERT INTO LoaiMyPham(TenLoaiMP, AnhDaiDien, MoTa)
VALUES(N'Dưỡng Mượt Tóc',N'/Images/danhmuc1.jpg', N'Các loại mỹ phẩm Dưỡng Tóc'),
      (N'Dầu Gội, Xả Tóc', N'/Images/danhmuc2.jpg', N' Các loại mỹ phẩm Dầu Gội'),
	  (N'Dưỡng Thể Body', N'/Images/danhmuc3.jpg',N' Các loại mỹ phẩm Dưỡng Thể'),
	  (N'Toner Hoa Hồng',N'/Images/danhmuc4.jpg',N' Các loại mỹ phẩm Toner'),
	  (N'Nước Hoa Thơm',N'/Images/danhmuc5.jpg',N' Các loại mỹ phẩm Nước hoa'),
	  (N'Trang Điểm Môi',N'/Images/danhmuc6.jpg',N' Các loại mỹ phẩm Son Môi'),
	  (N'Kem Nền Mịn',N'/Images/danhmuc7.jpg',N' Các loại mỹ phẩm Kem Nền'),
	  (N'K.Chống Nắng',N'/Images/danhmuc8.jpg',N' Các loại mỹ phẩm Kem'),
	  (N'Sữa Rửa Mặt',N'/Images/danhmuc9.jpg',N' Các loại mỹ phẩm Sữa Rửa Mặt'),
	  (N'Nước Tẩy Trang',N'/Images/danhmuc10.jpg',N'Các loại mỹ phẩm Nước Tẩy Trang'),
	  (N'Mascara',N'/Images',N'Các loại mỹ phẩm Mascara'),
      (N'Eyeliner',N'/Images',N' Các loại bút kẻ mắt'),
	  (N'Lotion',N'/Images',N' Các loại lotion'),
	  (N'Kem nghệ',N'/Images',N' Các loại kem nghệ'),
	  (N'Body mist',N'/Images',N' Các loại Body mist'),
	  (N'Sữa tắm',N'/Images',N' Các loại sữa tắm'),
	  (N'Dầu gội thường',N'/Images',N' Các loại dầu gội thường'),
	  (N'Dầu gội dược liệu',N'/Images',N' Các loại dầu gội dược liệu'),
	  (N'Vitamin',N'/Images',N' Các loại mỹ phẩm Vitamin'),
	  (N'Tẩy da chết',N'/Images',N' Các loại mỹ phẩm tẩy da chết')

--MyPham(MaMP, TenMP, MaLoaiMP,GiaMoi, GiaCu, DanhGia, SLTon, MoTa, GhiChu)
INSERT INTO MyPham(TenMP, MaLoaiMP, GiaBan, XuatXu, KhoiLuong, NgaySX, HSD, SLTon, AnhDaiDien, MoTa, GhiChu)
VALUES(N'Dầu LOreal Tinh Dầu Hoa Tự Nhiên',1,300000,N'VietNam',N'500gram','09-02-2024','09-02-2027',5, N'sp4.png', N'Dầu LOreal Tinh Dầu Hoa Tự Nhiên',N'Phù hợp với da dầu'),
      (N'Nước Xịt Dưỡng Tóc Double Rich',1,200000,N'France',N'300gram','05-02-2024','05-02-2027',100, N'sp5.jpg',N'Kem chống nắng Laroche Posay',N'Phù hợp với da nhạy cảm'),
	
	  (N'Dầu Gội Tsubaki Phục Hồi',2,500000,N'England',N'1000gram','08-03-2024','08-03-2027',50,N'daugoi1.jpg',N'Ngăn rụng tóc',N'Mượt tóc'),
	  (N'Bộ Gội Xả TRESemmé Keratin Vào Nếp',2,370000,N'France',N'600gram','05-02-2024','05-02-2027',150,N'daugoi2.jpg',N'Ngăn rụng tóc',N'Mượt tóc'),

	  (N'Sữa Dưỡng Thể Nivea Sáng Da',3,120000, N'VietNam',N'500gram','01-02-2024','01-02-2027',500,N'dt2.png',N'Sữa Dưỡng Thể Nivea Sáng Da',N'Phù hợp với mọi loại da'),
	  (N'Dầu Chăm Sóc Da Bio-Oil ',3,350000, N'France',N'300gram','05-02-2024','05-02-2027',100,N'dt4.jpg',N'Dầu Chăm Sóc Da Bio-Oil ',N'Phù hợp với da khô'),

	  (N'Toner Laroche Posay',4,300000, N'England',N'400gram','05-01-2024','05-01-2027',100,N't3.png',N'Toner Laroche Posay',N'Phù hợp với người trên 12 tuổi'),
	  (N'Nước hoa hồng Klair',4,450000, N'France',N'800gram','05-02-2024','05-02-2027',30,N't4.jpg',N'Nước hoa hồng Klair',N'Phù hợp với người trên 12 tuổi'),

	  (N'Nước hoa nữ Caloria',5,850000, N'France',N'300gram','06-09-2023','06-09-2026',50,N'nh2.png',N'Nước hoa nữ Caloria',N'Hương nữ'),
	  (N'Nước hoa nam Paco',5,990000, N'England',N'700gram','08-02-2023','08-02-2026',50,N'nh4.jpg',N'Nước hoa nam Paco',N'Hương nam'),

	  (N'Son Kem lì 3CE',6,350000, N'VietNam',N'900gram','03-03-2024','03-03-2027',100,N'sm2.jpg',N'Son Kem lì 3CE',N'Thơm và mềm môi'),
	  (N'Son Bóng Mac',6,250000, N'France',N'200gram','05-02-2024','05-02-2027',50,N'sm3.png',N'Son Bóng Mac',N'Thơm và mềm môi'),
	 
	  (N'Phấn Nước Lanegie Mịn',7,650000, N'France',N'300gram','09-01-2024','09-01-2027',30,N'm2.png',N'Phấn Nước Lanegie Mịn',N'Phù hợp với mọi loại da'),
	  (N'Kem Nền Maybeline',7,200000, N'England',N'300gram','05-02-2024','05-02-2027',100,N'm3.jpg',N'Kem Nền Maybeline',N'Phù hợp với mọi loại da'),
	  
	  (N'Kem Chống Nắng Laroche Posay',8,350000, N'England',N'200gram','05-02-2024','05-02-2027',100,N'kcn1.png',N'Kem Chống Nắng Laroche Posay',N'Phù hợp với da khô'),
	  (N'Kem Chống Nắng Centella 1004',8,250000, N'England',N'300gram','05-02-2024','05-02-2027',50,N'kcn2.png',N'Kem Chống Nắng Centella 1004',N'Phù hợp với da dầu'),
	   
	  (N'Sữa Rửa Mặt SVR',9,420000, N'France',N'700gram','09-01-2023','09-01-2028',100,N's1.png',N'Sữa Rửa Mặt SVR',N'Phù hợp với da khô'),
	  (N'Sữa Rửa Mặt Bí Đao Cocoon',9,200000, N'VietNam',N'800gram','02-08-2024','02-08-2025',50,N's2.png',N'Sữa Rửa Mặt Bí Đao Cocoon',N'Phù hợp với da dầu'),

	  (N'Tẩy Trang Biodema','L10',450000, N'VietNam',N'400gram','07-05-2024','07-05-2027',100,N'tt1.jpg',N'Tẩy Trang Biodema',N'Phù hợp với mọi loại dai'),
	  (N'Tẩy Trang Garnie','L10',250000, N'VietNam',N'300gram','06-06-2024','06-06-2027',50,N'tt2.png',N'Tẩy Trang Garnie',N'Phù hợp với mọi loại da')
   
--NhanVien(MaNV, HoTenNV,NgaySinh,GioiTinh, CaLam, Email, SDTNV, DiaChiNV)
INSERT INTO NhanVien(MaTaiKhoan, HoTenNV, ChucVu,Luong, CaLam, SDTNV, DiaChiNV)
VALUES(1,N'Mai Thị Hoa',N'Nhân viên bán hàng',200,'FullTime',0981890898,N'Mỹ Hào, Hưng Yên'),
      (2,N'Trần Tuấn',N'Nhân viên thu ngân',300,'PartTime',0904898998,N' Hưng Yên'),
      (3,N'Nguyễn An',N'Nhân viên kho',500,'FullTime',0996890777,N'Hà Nội'),
      (4,N'Vũ Thị Liên',N'Nhân viên bán hàng',300,N'FullTime',0984890005,N'Thái Bình'),
      (5,N'Lê Mai Anh',N'Nhân viên bán hàng',400,'PartTime',0946890123,N'Nam Định')

----KhachHang(IDKH, HoTenKH,LoaiKhachHang, SDTKH, DiaChiKH)
INSERT INTO KhachHang(MaTaiKhoan, HoTenKH, SDTKH, DiaChiKH)
VALUES(6,N'Trần Thị Liễu',09875678888,N'Yên Mỹ, Hưng Yên'),
	  (7,N'Vũ Thị Minh', 09455671232,N'Cẩm Giàng, Hải Dương'),
	  (8,N'Trịnh Thị Lan', 03435556777,N'Mỹ Hào, Hưng Yên'),
	  (9,N'Trần Thanh Thuỷ', 03538312793,N'Phù Cừ, Hưng Yên'),
      (10,N'Nguyễn Hoa Như', 09585638696,N'Mê Linh, Hà Nội')

--NHACC(MaNCC, HoTenNCC, SDTNCC, DiaChiNCC)
INSERT INTO NHACC(HoTenNCC, SDTNCC, DiaChiNCC)
VALUES(N'Cosmetic Hoa Lê', 0987233625,N'Bà Rịa, Vũng Tàu'),
	  (N'Cocoon Group', 0989233625,N'Thuận Thành, Bắc Ninh'),
	  (N'Sỉ lẻ Ngọc Bích', 0387233625,N'Cầu Giấy, Hà Nội'),
	  (N'Thanh Hằng Mỹ phẩm', 0357233625,N'Quận 9, TP Hồ Chí Minh'),
      (N'Makeup Beuty', 0997233622,N'Thanh Xuân, Hà Nội')

--HoaDonNhap(NgayNhap,MaTaiKhoan,MaNCC,KieuThanhToan,TongTien)
INSERT INTO HoaDonNhap(MaNV,MaNCC,NgayNhap,KieuThanhToan,TongTien)
VALUES(1,1,'2023-08-10','NCC04',N'Trả trước',500000),
      (2,2,'2023-09-26','NCC02',N'Trả sau',500000),
	  (3,3,'2022-07-28','NCC05',N'Trả trước',500000),
	  (4,4,'2023-05-10','NCC07',N'Trả trước',500000),
	  (5,5,'2023-12-15','NCC09',N'Trả trước',500000)

--ChiTietHoaDonNhap(TenMP, SLNhap, DGNhap, TrietKhau, ThanhTien)
INSERT INTO ChiTietHoaDonNhap(MaHDN, MaMP, TenMP, SLNhap, DGNhap, ThanhTien)
VALUES(1,N'Kem chống nắng Cetella',20, 250000,4500000),
      (2,N'Kem dưỡng ẩm Klieh',10, 300000,2700000),
	  (3,N'Mask Whitening',20, 20000,380000),
	  (4,N'Tinh dầu bưởi Cococoon',30, 150000,3825000),
      (5,N'Body mist Victoria ',20, 300000,6000000)

--HoaDonBan(HoTenKH, SDTKH, DiaChiKH, TrangThai, NgayTao, NgayDuyet, TongTien, TGGiaoHang)
INSERT INTO HoaDonBan(HoTenKH, SDTKH, DiaChiKH, TrangThai, NgayTao, NgayDuyet, TongTien, TGGiaoHang)
VALUES(N'Trần Thị Liễu','0987567888',N'Yên Mỹ, Hưng Yên',2,'2023-05-20','2023-05-21', 600000,'2023-05-22'),
	  (N'Vũ Thị Minh','0945567123',N'Cẩm Giàng, Hải Dương',1,'2023-04-21','2023-04-23',700000,'2023-04-25'),
	  (N'Trần Thanh Thuỷ','0353831279',N'Phù Cừ, Hưng Yên',1,'2023-05-07','2023-05-08',800000,'2023-05-09'),
	  (N'Nguyễn Hoa Như','0958563869',N'Mê Linh, Hà Nội',2,'2023-06-24','2023-06-25',200000,'2023-06-26'),
	  (N'Vũ Thị Minh','0945567123',N'Cẩm Giàng, Hải Dương',2,'2023-05-07','2023-05-08',1000000,'2023-05-08')


--ChiTietHoaDonBan(MaMP, SLBan, DGBan, GiamGia, ThanhTien)
INSERT INTO ChiTietHoaDonBan(MaHDB, MaMP, SLBan, TongTien)
VALUES(1,1,10,500000),
      (2,2,10,6000000),
	  (4,4,20,800000),
	  (5,5,30,200000),
	  (6,6,20,300000)

SELECT * FRom ChiTietHoaDonBan